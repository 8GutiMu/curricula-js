<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Recursividad en JavaScript</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article">
<div id="header">
<h1>Recursividad en JavaScript</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introducción">1. Introducción</a></li>
<li><a href="#_factorial">2. Factorial</a>
<ul class="sectlevel2">
<li><a href="#_tarea">2.1. Tarea</a></li>
</ul>
</li>
<li><a href="#_caso_base_caso_recursivo">3. Caso base, caso recursivo</a></li>
<li><a href="#_condición_de_terminación">4. Condición de terminación</a>
<ul class="sectlevel2">
<li><a href="#_tarea_2">4.1. Tarea</a></li>
</ul>
</li>
<li><a href="#_argumentos_en_la_recursión">5. Argumentos en la recursión</a>
<ul class="sectlevel2">
<li><a href="#_tarea_3">5.1. Tarea</a></li>
</ul>
</li>
<li><a href="#_ahora_es_tu_turno">6. Ahora es tu turno</a>
<ul class="sectlevel2">
<li><a href="#_plantilla">6.1. Plantilla</a></li>
</ul>
</li>
<li><a href="#_pila_de_llamadas_call_stack">7. Pila de llamadas (Call Stack)</a></li>
<li><a href="#_tail_call_optimisation">8. Tail-call Optimisation</a>
<ul class="sectlevel2">
<li><a href="#_tarea_4">8.1. Tarea</a></li>
<li><a href="#_estrategia_para_la_optimización_de_llamadas_de_cola">8.2. Estrategia para la optimización de llamadas de cola</a></li>
</ul>
</li>
<li><a href="#_trampolining">9. Trampolining</a></li>
<li><a href="#_otros_ejercicios_que_puedes_hacer">10. Otros ejercicios que puedes hacer</a></li>
<li><a href="#_referencias">11. Referencias</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introducción">1. Introducción</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La recursividad es un concepto de programación. No es un concepto exclusivo de
JavaScript, se utiliza en muchos lenguajes de programación. Tampoco es un
tipo de datos, una función, un objeto o un método. No está restringido por una
sola llamada de sentencia como las estructuras de control <code>if</code> o <code>while</code>.</p>
</div>
<div class="paragraph">
<p>La definición de libro de texto para recursividad es: el llamado que hace una
función sobre sí misma. Pero, ¿Qué significa esto realmente?</p>
</div>
<div class="paragraph">
<p>La recursividad es uno de los conceptos de programación más simples pero
difíciles de entender. Una vez que empieces a trabajar con ella y tratar de
entender realmente cómo funciona, tal vez te sientas mareada y confundida, por
eso trataremos de explicarlo de forma sencilla. Ayudará mucho si ya entiendes
los conceptos de función y estructuras de control.</p>
</div>
<div class="paragraph">
<p>A lo largo de esta lección veremos que la recursión es importante para la
programación funcional por las siguientes razones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Las soluciones recursivas envuelven el uso de abstracciones simples aplicadas
a subconjuntos de un problema común.</p>
</li>
<li>
<p>La recursión puede ocultar la mutación del estado.</p>
</li>
<li>
<p>La recursión es una manera de implementar <em>lazyness</em> y estructuras muy largas
o infinitas.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_factorial">2. Factorial</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Este es el ejemplo clásico para entender la recursividad: <strong>factoriales.</strong></p>
</div>
<div class="paragraph">
<p>Si te acuerdas de la clase de matemáticas, cuando se calcula el factorial de un
número <code>n</code> es igual a <code>n</code> multiplicado por el \$fact\o\rial(n - 1)\$ para cada
entero positivo.</p>
</div>
<div class="stemblock">
<div class="title">n!</div>
<div class="content">
\$n! = n * (n - 1) * (n - 2) cdots 3 * 2 * 1\$
</div>
</div>
<div class="stemblock">
<div class="content">
\$n! = n * [(n - 1) * (n - 2) cdots 3 * 2 * 1] = n * (n - 1)!\$
</div>
</div>
<div class="paragraph">
<p>Así que el factorial de 5 es igual a 5 * 4 * 3 * 2 * 1, lo que nos da como
resultado 120.</p>
</div>
<div class="stemblock">
<div class="title">factorial(5)</div>
<div class="content">
\$5! = 5 * 4 * 3 * 2 * 1 = 120\$
</div>
</div>
<div class="paragraph">
<p>En la programación, los factoriales son un ejemplo perfecto de un caso en el que
se debe utilizar una función recursiva. ¿Por qué? Porque estamos haciendo lo
mismo (multiplicación) una y otra vez a un valor particular (un entero positivo)
hasta que obtenemos el resultado deseado.</p>
</div>
<div class="paragraph">
<p>En principo desarrollemos, como ya hemos viniendo haciendo, el caso de prueba:</p>
</div>
<div class="listingblock">
<div class="title">factorial.test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers">1</span>const factorial = require(<span class="string"><span class="delimiter">'</span><span class="content">./factorial</span><span class="delimiter">'</span></span>)
<span class="line-numbers">2</span>
<span class="line-numbers">3</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should calculate the factorial of the given number</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers">4</span>  expect(factorial(<span class="integer">5</span>)).toBe(<span class="integer">120</span>)
<span class="line-numbers">5</span>})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Una primera implementación que cumple caso de pruebas especificado es la
siguiente:</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = n =&gt; {
<span class="line-numbers"> 2</span>  <span class="keyword">if</span> (n === <span class="integer">0</span>) {
<span class="line-numbers"> 3</span>    <span class="keyword">return</span> <span class="integer">1</span>
<span class="line-numbers"> 4</span>  }
<span class="line-numbers"> 5</span>
<span class="line-numbers"> 6</span>  <span class="comment">// ¡Aquí está la recursión!</span>
<span class="line-numbers"> 7</span>  <span class="keyword">return</span> n * factorial(n - <span class="integer">1</span>)
<span class="line-numbers"> 8</span>}
<span class="line-numbers"> 9</span>
<span class="line-numbers">10</span>module.exports = factorial</code></pre>
</div>
</div>
<div class="paragraph">
<p>Demostremos que nuestra implementación cumple con el caso de prueba:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn run jest -- factorial.test.js

PASS  ./factorial.test.js

  ✓ Should calculate the factorial of the given number (3ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.638s, estimated 1s
Ran all test suites matching &quot;factorial.test.js&quot;.
Done in 1.12s.</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_tarea">2.1. Tarea</h3>
<div class="paragraph">
<p>Intenta utilizar la misma función <code>factorial()</code> pero en este caso para el
entero 10.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_caso_base_caso_recursivo">3. Caso base, caso recursivo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hay características claves de la recursión que deben incluirse en tu código para
que funcione correctamente.</p>
</div>
<div class="paragraph">
<p>El primer caso a estudiar es el <strong>caso base</strong>: es sólo una línea de código o
sentencia, normalmente dentro de una cláusula condicional como <code>if</code> que detiene
la recursión. Si no se tiene un caso base, la recursión continuará infinitamente
y tu programa se bloqueará (lo cual no es bueno).</p>
</div>
<div class="paragraph">
<p>El segundo es el <strong>caso recursivo</strong>: ésta es la afirmación donde la recursión
realmente sucede: es donde la función recursiva se llama a sí misma.</p>
</div>
<div class="paragraph">
<p>Vamos a explorar ambos casos con más detalle.</p>
</div>
<div class="paragraph">
<p>Mira bien el código del ejemplo a continuación, ¿crees que tiene lógica?, ¿no?
No importa que no lo comprendas del todo por ahora, iremos explicando sección
por sección.</p>
</div>
<div class="paragraph">
<p>Como ejercicio puedes llamar la función <code>factorial()</code> usando cualquier número
entero positivo.</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = n =&gt; {
<span class="line-numbers"> 2</span>  <span class="comment">// Este es nuestro caso base - cuando n es igual a 0, se detiene la recursión</span>
<span class="line-numbers"> 3</span>  <span class="comment">// Devolvemos 1 pues es el elemento neutro de la multiplicación</span>
<span class="line-numbers"> 4</span>  <span class="keyword">if</span> (n === <span class="integer">0</span>) {
<span class="line-numbers"> 5</span>    <span class="keyword">return</span> <span class="integer">1</span>
<span class="line-numbers"> 6</span>  }
<span class="line-numbers"> 7</span>
<span class="line-numbers"> 8</span>  <span class="comment">// Este es nuestro caso recursivo</span>
<span class="line-numbers"> 9</span>  <span class="comment">// Correrá para todas las condiciones de n excepto cuando n es igual a 0</span>
<span class="line-numbers">10</span>  <span class="keyword">return</span> n * factorial(n - <span class="integer">1</span>)
<span class="line-numbers">11</span>}
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>module.exports = factorial</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_condición_de_terminación">4. Condición de terminación</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Otra característica útil (y a menudo necesaria) de una función recursiva es la
<strong>condición de terminación</strong>.</p>
</div>
<div class="paragraph">
<p>Esta es una declaración específica que detendrá explícitamente la recursión. El
caso base es una forma de condición de terminación, aunque para nuestros fines
usaremos la condición de terminación para describir una sentencia que cancelará
la recursión en el caso de una entrada incorrecta u otro error potencial.</p>
</div>
<div class="paragraph">
<p>Para poner esto en práctica, mira la función factorial. ¿Qué pasaría si la
llamáramos usando un entero negativo? Dado que la recursión sólo se detendrá
cuando n es igual a 0, y eso nunca sucedería con un entero negativo, nuestro
programa se bloquearía.</p>
</div>
<div class="paragraph">
<p>Agreguemos un caso de prueba para demostrar lo indicado en el párrafo anterior:</p>
</div>
<div class="listingblock">
<div class="title">factorial.test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = require(<span class="string"><span class="delimiter">'</span><span class="content">./factorial.verbose</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should calculate the factorial of the given number</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers"> 4</span>  expect(factorial(<span class="integer">5</span>)).toBe(<span class="integer">120</span>)
<span class="line-numbers"> 5</span>})
<span class="line-numbers"> 6</span>
<span class="line-numbers"> 7</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should not accept negative values</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers"> 8</span>  expect(() =&gt; {
<span class="line-numbers"> 9</span>    factorial(-<span class="integer">1</span>)
<span class="line-numbers">10</span>  }).toThrow(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers">11</span>})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si ejecutamos nuestras pruebas obtendremos lo siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn run jest -- factorial.test.js

FAIL  ./factorial.test.js

  ● Should not accept negative values

    RangeError: Maximum call stack size exceeded

      at factorial (factorial.js:1:108)
      at factorial (factorial.js:9:14)
      ...
      at factorial (factorial.js:9:14)


  ✓ Should calculate the factorial of the given number (3ms)
  ✕ Should not accept negative values (3ms)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 passed, 2 total
Snapshots:   0 total
Time:        0.685s, estimated 1s
Ran all test suites matching &quot;factorial.test.js&quot;.</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>¡Ouch!</strong>, nuestro programa está fallando.</p>
</div>
<div class="paragraph">
<p>Para evitar que esto suceda, utilizaremos una condición de terminación para
asegurarnos que el valor pasado a la función sea válido y no bloquee nuestro
programa. Como programadora, debes estar constantemente pensando en cómo estar
preparada para cualquier tipo de situación y asegurarte de que tu código puede
manejarla correctamente.</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = n =&gt; {
<span class="line-numbers"> 2</span>  <span class="keyword">if</span> (n &lt; <span class="integer">0</span>) {
<span class="line-numbers"> 3</span>    <span class="comment">// Condición de terminación para prevenir recursividad infinita</span>
<span class="line-numbers"> 4</span>    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 5</span>  }
<span class="line-numbers"> 6</span>
<span class="line-numbers"> 7</span>  <span class="comment">// Caso base</span>
<span class="line-numbers"> 8</span>  <span class="keyword">if</span> (n === <span class="integer">0</span>) {
<span class="line-numbers"> 9</span>    <span class="keyword">return</span> <span class="integer">1</span>
<span class="line-numbers">10</span>  }
<span class="line-numbers">11</span>
<span class="line-numbers">12</span>  <span class="comment">// Caso recursivo</span>
<span class="line-numbers">13</span>  <span class="keyword">return</span> n * factorial(n - <span class="integer">1</span>)
<span class="line-numbers">14</span>}
<span class="line-numbers">15</span>
<span class="line-numbers">16</span>module.exports = factorial</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ejecutemos ahora nuestras pruebas:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn run jest -- factorial.test.js

 PASS  ./factorial.test.js

  ✓ Should calculate the factorial of the given number (3ms)
  ✓ Should not accept negative values

Test Suites: 1 passed, 1 total
Tests:       2 passed, 2 total
Snapshots:   0 total
Time:        0.674s, estimated 1s
Ran all test suites matching &quot;factorial.test.js&quot;.
Done in 1.29s.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Todo parece indicar que la condición de terminación nos ha servido para solventar
el error antes presentado.</p>
</div>
<div class="sect2">
<h3 id="_tarea_2">4.1. Tarea</h3>
<div class="paragraph">
<p>Puedes intentar describir un nuevo escenario de prueba para ver qué sucede
cuando se pasa un valor no válido a la función <code>factorial()</code>. Al encontrar una
falla, puedes intentar mejorar la implementación de la función <code>factorial()</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_argumentos_en_la_recursión">5. Argumentos en la recursión</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cuando empieces a construir tu caso recursivo (el código que se repetirá), una
de las reglas es asegurarse que los argumentos que utiliza para la recursión
llevará a un caso base.</p>
</div>
<div class="paragraph">
<p>Si el valor que le pasamos a la llamada de la función recursiva es el mismo que
el valor inicial, es probable que nuestro código entre en un bucle infinito, e
inevitablemente se bloqueará.</p>
</div>
<div class="paragraph">
<p>Por lo tanto, la pregunta que debes hacerte es: ¿el caso recursivo modifica los
argumentos de tal manera que cada recursión lo acerca más al caso base?</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = n =&gt; {
<span class="line-numbers"> 2</span>  <span class="comment">// Condición de terminación para prevenir la recursión infinita</span>
<span class="line-numbers"> 3</span>  <span class="keyword">if</span> (n &lt; <span class="integer">0</span>) {
<span class="line-numbers"> 4</span>    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 5</span>  }
<span class="line-numbers"> 6</span>
<span class="line-numbers"> 7</span>  <span class="comment">// Caso base</span>
<span class="line-numbers"> 8</span>  <span class="keyword">if</span> (n === <span class="integer">0</span>) {
<span class="line-numbers"> 9</span>    <span class="keyword">return</span> <span class="integer">1</span>
<span class="line-numbers">10</span>  }
<span class="line-numbers">11</span>
<span class="line-numbers">12</span>  <span class="keyword">return</span> n * factorial(n) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="line-numbers">13</span>}
<span class="line-numbers">14</span>
<span class="line-numbers">15</span>factorial(<span class="integer">6</span>)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>¿Qué está mal? ¿Por qué no funciona la recursión?</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_tarea_3">5.1. Tarea</h3>
<div class="paragraph">
<p>Ejecuta el código del ejemplo anterior.</p>
</div>
<div class="paragraph">
<p>Hmm&#8230;&#8203; algo está mal.</p>
</div>
<div class="paragraph">
<p>Observa atentamente la última línea de definición de la función factorial y
cámbiala para que el factorial funcione correctamente.</p>
</div>
<div class="paragraph">
<p>Utiliza los casos de pruebas antes mostrados para ver que todo funcione
correctamente.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ahora_es_tu_turno">6. Ahora es tu turno</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ahora que hemos cubierto lo esencial, trata de reconstruir la función
<code>factorial()</code> en la que hemos estado trabajando, pero esta vez escríbelo todo
desde cero. Para ayudarte, aquí hay cinco preguntas que puedes utilizar siempre
que vayas a incluir la recursión en tu código:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>¿Cuáles son los casos básicos?</p>
</li>
<li>
<p>¿Cuál es el caso recursivo?, ¿hay más de un caso recursivo?</p>
</li>
<li>
<p>¿He incluido alguna otra condición de terminación necesaria?</p>
</li>
<li>
<p>¿Las declaraciones de la función conducen al caso base?</p>
</li>
<li>
<p>¿Se construye la recursión en el caso base hasta que el resultado deseado es
devuelto por la función?</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_plantilla">6.1. Plantilla</h3>
<div class="paragraph">
<p>Define el caso base. Dado que un factorial significa multiplicar un entero por
cada entero entre él mismo y uno, el caso base es uno.</p>
</div>
<div class="paragraph">
<p>Define el caso recursivo. ¿Qué acciones deben realizarse una y otra vez para
lograr el resultado deseado?</p>
</div>
<div class="paragraph">
<p>Escribe cualquier condición de terminación para evitar que la función acepte
argumentos que puedan dar  error.</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">const factorial = n =&gt; {
  <span class="comment">// Aquí va tu código.</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Llegados a este punto, imagina por un momento que completaste la tarea y
compartiste tus resultados con tus amigas, una compañera mientras hacia revisión
de tú código encontró un comportamiento extraño, su caso de prueba fue el
siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">&gt; factorial(32768)
RangeError: Maximum call stack size exceeded</code></pre>
</div>
</div>
<div class="paragraph">
<p>Por si no lo recuerdas, este error ya lo habíamos visto antes, cuando intentamos
calcular el <code>factorial(-1)</code> y no teníamos la <strong>condición de terminación</strong>
apropiada.</p>
</div>
<div class="paragraph">
<p>Ahora bien, para poder resolver este problema, primero debemos dejar claro un
concepto que no habíamos explicado anteriormente, definamos entonces qué es la
pila de llamadas o <em>Call Stack</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pila_de_llamadas_call_stack">7. Pila de llamadas (Call Stack)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sería útil examinar más de cerca la forma en que se maneja el control a través
de las funciones. Aquí está un programa simple que hace algunas llamadas a
funciones:</p>
</div>
<div class="listingblock">
<div class="title">greet</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers">1</span><span class="keyword">function</span> <span class="function">greet</span>(who) {
<span class="line-numbers">2</span>  console.log(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span> + who) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="line-numbers">3</span>} <i class="conum" data-value="3"></i><b>(3)</b>
<span class="line-numbers">4</span>greet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Harry</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="line-numbers">5</span>console.log(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bye</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>La llamada a <code>greet</code> hace que el control salte al inicio de esa función
(línea 2).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Se hace una llamada a <code>console.log</code> (una función predeterminada del
navegador), esta función toma el control, hace su trabajo, devuelve el control
a la línea 2.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Entonces llega al final de la función <code>greet</code>, así que el control se vuelve
al lugar de la llamada, en la línea 4.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>La línea siguiente llama a <code>console.log</code> de nuevo (línea 5).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Veamos otra representación de lo mencionado previamente, mostraremos un esquema
de cómo fluye el control en la función:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>top
    greet
        console.log
    greet
top
    console.log
top</pre>
</div>
</div>
<div class="paragraph">
<p>Como la función debe saltar de nuevo al lugar de la llamada original cuando
llega la final de la función, la computadora debe recordar el contexto o entorno
desde el cual se hizo la llamada a la función. Por ejemplo en un caso,
<code>console.log</code> tiene que volver a saltar a la función <code>greet</code>. En otro caso, debe
saltar al final del programa.</p>
</div>
<div class="paragraph">
<p>El lugar donde la computadora almacena este contexto es la pila de llamadas o
<em>call stack</em>. Cada vez que se hace una llamada a una función, el contexto actual
se pone encima de esta pila de llamadas. Cuando la función se devuelve, elimina
el contexto superior de la pila y lo utiliza para continuar con la ejecución de
la función.</p>
</div>
<div class="paragraph">
<p>El almacenamiento de  esta pila requiere espacio en la memoria de la
computadora. Cuando la pila crece demasiado, la computadora fallará y mostrará
un mensaje como "No hay espacio en la pila" o "Hay demasiada recursión". El
código siguiente ilustra esto haciendo una pregunta realmente difícil a la
computadora, esto causa llamadas infinitas hacia adelante y hacia atrás entre
dos funciones. Como la computadora no tiene una pila infinita, se queda sin
espacio, y sucede que "explotamos la pila".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">function</span> <span class="function">chicken</span>() {
  <span class="keyword">return</span> egg()
}
<span class="keyword">function</span> <span class="function">egg</span>() {
  <span class="keyword">return</span> chicken()
}
console.log(chicken() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> came first.</span><span class="delimiter">&quot;</span></span>)
<span class="comment">// → ??</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Esto es precisamente lo que está pasando con nuestra función <code>factorial</code>, a
partir de ciertos enteros positivos nuestra pila de llamadas crece demasido y
obtenemos el error: <em>Maximum call stack size exceeded</em>. Veamos entonces si
podemos solventar dicho error.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tail_call_optimisation">8. Tail-call Optimisation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La optimización de llamadas de cola o <em>tail-call optimisation</em> es una
característica del compilador que reemplaza las invocaciones de funciones
recursivas con una estructura de control o bucle. La eliminación de las
invocaciones de funciones elimina tanto el tamaño de la pila como el tiempo
necesario para configurar los marcos de la pila de funciones. Tanto el tiempo
como el espacio se guardan.</p>
</div>
<div class="paragraph">
<p>La programadora debe escribir métodos de una manera que facilite la
optimización de llamadas de cola. Esto significa que la última función invocada
debe ser la invocación de la función recursiva. Si revisamos con detenimiento
nuestra función <code>factorial</code> podremos apreciar que nuestra llamada recursiva es
como sigue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">return</span> n * factorial(n - <span class="integer">1</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cabe preguntarnos si <strong>la última función invocada debe ser la función recursiva</strong>,
en nuestra implementación actual en realidad es la multiplicación lo que se
invoca de último. Sin embargo, podemos mejorar la implementación tal como sigue:</p>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span><span class="string"><span class="delimiter">'</span><span class="content">use strict</span><span class="delimiter">'</span></span>
<span class="line-numbers"> 2</span>const factorial = (n, acc = <span class="integer">1</span>) =&gt; {
<span class="line-numbers"> 3</span>  <span class="keyword">if</span> (n &lt; <span class="integer">0</span>) {
<span class="line-numbers"> 4</span>    <span class="comment">// Condición de terminación para prevenir recursividad infinita</span>
<span class="line-numbers"> 5</span>    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 6</span>  }
<span class="line-numbers"> 7</span>
<span class="line-numbers"> 8</span>  <span class="comment">// Caso base</span>
<span class="line-numbers"> 9</span>  <span class="keyword">if</span> (n === <span class="integer">0</span>) {
<span class="line-numbers">10</span>    <span class="keyword">return</span> acc
<span class="line-numbers">11</span>  }
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>  <span class="comment">// Caso recursivo</span>
<span class="line-numbers">14</span>  <span class="keyword">return</span> factorial(n - <span class="integer">1</span>, n * acc)
<span class="line-numbers">15</span>}
<span class="line-numbers">16</span>
<span class="line-numbers">17</span>module.exports = factorial</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta implementación del <code>factorial</code> ahora si hace <em>tail-call recursion</em> y por
ende está optimizada, nota que la última función llamada es <code>factorial</code> y no la
multiplicación (caso previo). De este modo, el compilador es capaz de invocar
<code>factorial</code>  en un bucle hasta que se devuelva un resultado distinto a este en
la repetición.</p>
</div>
<div class="paragraph">
<p>Nota que hemos agregado un parámetro adicional a <code>factorial</code> este parametro es
<code>acc</code>. Este es el acumulador, <code>acc</code> es el valor de función acumulado hasta este
punto. Hagamos una simulación escrita del método recurrente para ver cómo se
acumula el resultado factorial:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>factorial(5)
factorial(5, 1)
factorial(4, 5)
factorial(3, 20)
factorial(2, 60)
factorial(1, 120)
factorial(0, 120)
120</pre>
</div>
</div>
<div class="paragraph">
<p>Todas las funciones recursivas deben tener un caso base que termine la
recursión. Anteriormente el caso base para la función <code>factorial</code> es cuando n =
0, en cuyo caso se devuelve 1. Con esta nueva implementación, el caso base de
<code>factorial</code> es también cuando n = 0, pero en lugar de retornar 1, se devuelve el
valor acumulado o <code>acc</code>.</p>
</div>
<div class="sect2">
<h3 id="_tarea_4">8.1. Tarea</h3>
<div class="paragraph">
<p>Nuestra nueva implementación de <code>factorial</code> igualmente tiene un problema, si
bien hacemos uso de una característica de ES2015, la cual es la definición de
paramétros por omisión de una función, un usuario podría invocar nuestra nueva
función <code>factorial</code> de la siguiente manera: <code>factorial(5, 2)</code>, ¿qué crees que
pasaría en dicho caso?, trata de hacer una simulación escrita antes de ejecutar
código, ¿el resultado es correcto?</p>
</div>
<div class="paragraph">
<p>Un modo de corregir la nueva implementación es siguiendo la siguientes consejos:</p>
</div>
</div>
<div class="sect2">
<h3 id="_estrategia_para_la_optimización_de_llamadas_de_cola">8.2. Estrategia para la optimización de llamadas de cola</h3>
<div class="paragraph">
<p>Utiliza esta estrategia para crear funciones recursivas optimizadas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crear una función recursiva interna que tenga un parámetro acumulador
adicional</p>
</li>
<li>
<p>El caso base de la función recursiva interna será devolver el
acumulador</p>
</li>
<li>
<p>La invocación recursiva proporciona un valor actualizado para el acumulador</p>
</li>
<li>
<p>La función externa delega a la función recursiva interna usando los valores
iniciales apropiados</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sigue estas estrategias y tus funciones recursivas serán óptimas, proporcionando
mejoras significativas en el rendimiento.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Nota</div>
<div class="paragraph">
<p>Si tú código fuese a producción con este implementación, se utilizarían otras
técnicas como <a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/">IIFEs</a>
entre otras para encapsular y prevenir la creación de un nuevo <em>closure</em> cada
vez que llamamos a <code>factorial</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si probamos la función <code>factorial</code> haciendo uso de <em>tail-call optimisation</em> con
números enteros positivos pequeños observamos que todo funciona de igual manera,
pero, en esta ocasión debemos actualizar nuestro caso de pruebas para incluir
el ejemplo que nos dio nuestra amiga:</p>
</div>
<div class="listingblock">
<div class="title">factorial.test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span>const factorial = require(<span class="string"><span class="delimiter">'</span><span class="content">./factorial.tail</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should calculate the factorial of the given number</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers"> 4</span>  expect(factorial(<span class="integer">5</span>)).toBe(<span class="integer">120</span>)
<span class="line-numbers"> 5</span>})
<span class="line-numbers"> 6</span>
<span class="line-numbers"> 7</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should not accept negative values</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers"> 8</span>  expect(() =&gt; {
<span class="line-numbers"> 9</span>    factorial(-<span class="integer">1</span>)
<span class="line-numbers">10</span>  }).toThrow(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers">11</span>})
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>test(<span class="string"><span class="delimiter">'</span><span class="content">Should avoid too much recursion</span><span class="delimiter">'</span></span>, () =&gt; {
<span class="line-numbers">14</span>  expect(() =&gt; {
<span class="line-numbers">15</span>    factorial(<span class="integer">32768</span>)
<span class="line-numbers">16</span>  }).not.toThrowError(<span class="regexp"><span class="delimiter">/</span><span class="content">stack size exceeded</span><span class="delimiter">/</span></span>)
<span class="line-numbers">17</span>})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si ejecutamos nuestras pruebas obtendremos un resultado similar al siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn run jest -- factorial.test.js

 FAIL  ./factorial.tail.test.js
  ● Should avoid too much recursion

    expect(function).not.toThrowError(regexp)

    Expected the function not to throw an error matching:
      /stack size exceeded/
    Instead, it threw:
      RangeError: Maximum call stack size exceeded

  ✓ Should calculate the factorial of the given number (5ms)
  ✓ Should not accept negative values (1ms)
  ✕ Should avoid too much recursion (10ms)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 2 passed, 3 total
Snapshots:   0 total
Time:        0.656s, estimated 1s
Ran all test suites matching &quot;factorial.test.js&quot;.</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>(o_O)</strong></p>
</div>
<div class="paragraph">
<p>¡Un momento!, ¿qué ha pasado?, ¿por qué sigue fallando?.</p>
</div>
<div class="paragraph">
<p>Pues resulta que es importante mencionar que esto funcionará si tu sistema
proporciona optimizaciones de llamadas de cola. Ya que JavaScript no lo hace en
la mayoría de sus implementaciones, tal como se indica
<a href="https://babeljs.io/learn-es2015/#ecmascript-2015-features-tail-calls">acá</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Nota</div>
<div class="paragraph">
<p>Al momento de la publicación de esta lección, la única implementación de
JavaScript conocida por el autor que soporta tail-call optimisation es
<a href="https://github.com/Kinoma/kinomajs">KinomaJS</a>, la cual ofrece un <em>runtime</em>
optimizado para el desarrollo de aplicaciones que funcionen en dispositivos IoT
y ofrecen compatibilidad con ES6, de hecho,
<a href="http://kinoma.com/develop/documentation/js6/">acá</a> puedes ver los resultados de
sus pruebas.</p>
</div>
<div class="paragraph">
<p>Si bien no es necesario para los objetivos de este curso, puedes intentar
descargar el código de KinomaJS pues es <em>Open Source</em>, construirla y correr la
<em>suite</em> de pruebas que ofrecen y corroborar por tu cuenta.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ahora que sabemos que la mayoría de las implementaciones de JavaScript no
implementan todavía la <em>tail-call optimisation</em> es necesario ver si existen
otras alternativas con las cuales podamos solventar el error antes visto.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trampolining">9. Trampolining</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span><span class="string"><span class="delimiter">'</span><span class="content">use strict</span><span class="delimiter">'</span></span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>const isFunction = require(<span class="string"><span class="delimiter">'</span><span class="content">lodash.isfunction</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 4</span>
<span class="line-numbers"> 5</span>const trampoline = (fn, ...args) =&gt; {
<span class="line-numbers"> 6</span>  let result = fn.apply(fn, args)
<span class="line-numbers"> 7</span>
<span class="line-numbers"> 8</span>  <span class="keyword">while</span> (isFunction(result)) {
<span class="line-numbers"> 9</span>    result = result()
<span class="line-numbers">10</span>  }
<span class="line-numbers">11</span>
<span class="line-numbers">12</span>  <span class="keyword">return</span> result
<span class="line-numbers">13</span>}
<span class="line-numbers">14</span>
<span class="line-numbers">15</span>const factorial = n =&gt; {
<span class="line-numbers">16</span>  <span class="keyword">if</span> (n &lt; <span class="integer">0</span>) {
<span class="line-numbers">17</span>    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers">18</span>  }
<span class="line-numbers">19</span>
<span class="line-numbers">20</span>  const fun = (n, acc = <span class="integer">1</span>) =&gt; {
<span class="line-numbers">21</span>    <span class="keyword">return</span> n ? () =&gt; fun(n - <span class="integer">1</span>, n * acc) : acc
<span class="line-numbers">22</span>  }
<span class="line-numbers">23</span>
<span class="line-numbers">24</span>  <span class="keyword">return</span> trampoline(fun(n))
<span class="line-numbers">25</span>}
<span class="line-numbers">26</span>
<span class="line-numbers">27</span>module.exports = factorial</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tras este ultimo cambio ejecutemos nuestras pruebas.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn run jest -- factorial.test.js

 PASS  ./factorial.safe.test.js
  ✓ Should calculate the factorial of the given number (3ms)
  ✓ Should not accept negative values (1ms)
  ✓ Should avoid too much recursion (7ms)

Test Suites: 1 passed, 1 total
Tests:       3 passed, 3 total
Snapshots:   0 total
Time:        0.648s, estimated 1s
Ran all test suites matching &quot;factorial.test.js&quot;.
Done in 1.15s.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Con esto ya hemos evitado saturar el <em>stack</em>. Sin embargo, el resultado es el
siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; factorial(32768)
Infinity</pre>
</div>
</div>
<div class="paragraph">
<p><strong>(o_O)</strong></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">Advertencia</div>
<div class="paragraph">
<p>Este error se debe a otra limitación en JavaScript, esta vez relacionada con el
manejo de enteros largos. Si bien la reparación de este último <em>bug</em> está fuera
del alcance de la lección actual, igual se mostrará su resolución para completar
el recorrido.</p>
</div>
<div class="paragraph">
<p>Esta limitación puede ser arreglada haciendo uso de
<a href="https://github.com/peterolson/BigInteger.js">BigInteger.js</a>. Ejecutemos entonces</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ yarn add --dev big-integer</code></pre>
</div>
</div>
<div class="paragraph">
<p>y ajustemos de nuevo nuestra implementación.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">factorial.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="line-numbers"> 1</span><span class="string"><span class="delimiter">'</span><span class="content">use strict</span><span class="delimiter">'</span></span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>const isFunction = require(<span class="string"><span class="delimiter">'</span><span class="content">lodash.isfunction</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 4</span>const bigInt = require(<span class="string"><span class="delimiter">'</span><span class="content">big-integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers"> 5</span>
<span class="line-numbers"> 6</span>const trampoline = (fn, ...args) =&gt; {
<span class="line-numbers"> 7</span>  let result = fn.apply(fn, args)
<span class="line-numbers"> 8</span>
<span class="line-numbers"> 9</span>  <span class="keyword">while</span> (isFunction(result)) {
<span class="line-numbers">10</span>    result = result()
<span class="line-numbers">11</span>  }
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>  <span class="keyword">return</span> result
<span class="line-numbers">14</span>}
<span class="line-numbers">15</span>
<span class="line-numbers">16</span>const factorial = n =&gt; {
<span class="line-numbers">17</span>  <span class="keyword">if</span> (n &lt; <span class="integer">0</span>) {
<span class="line-numbers">18</span>    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string"><span class="delimiter">'</span><span class="content">Cannot compute the factorial of a negative integer</span><span class="delimiter">'</span></span>)
<span class="line-numbers">19</span>  }
<span class="line-numbers">20</span>
<span class="line-numbers">21</span>  const fun = (n, acc = bigInt.one) =&gt; {
<span class="line-numbers">22</span>    <span class="keyword">return</span> n.greater(<span class="integer">0</span>) ? () =&gt; fun(n.minus(<span class="integer">1</span>), acc.multiply(n)) : acc
<span class="line-numbers">23</span>  }
<span class="line-numbers">24</span>
<span class="line-numbers">25</span>  <span class="keyword">return</span> trampoline(fun(bigInt(n)))
<span class="line-numbers">26</span>}
<span class="line-numbers">27</span>
<span class="line-numbers">28</span>module.exports = factorial</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ahora podremos obtener una representación que nos funciona para números grandes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; factorial(5)
{ [Number: 120] value: 120, sign: false, isSmall: true }
&gt; factorial(5) == 120
true
&gt; factorial(180)
{ [Number: Infinity]
  value:
   [ 0,
     0,
     0,
     0,
     0,
     0,
     9603200,
     3198603,
     3278187,
     2302693,
     9233864,
     7538181,
     4141796,
     3001782,
     1142564,
     4664891,
     6331964,
     5603584,
     809209,
     5744504,
     8568581,
     5064353,
     1980647,
     6535588,
     972945,
     3196673,
     6095985,
     1495273,
     3218633,
     6710321,
     7399609,
     9410103,
     7356315,
     2097309,
     8013811,
     9809411,
     953395,
     6004486,
     4353351,
     7777940,
     4079886,
     9175403,
     8466838,
     5133689,
     2996569,
     2499134,
     89606,
     2 ],
  sign: false,
  isSmall: false }</pre>
</div>
</div>
<div class="paragraph">
<p>Y dichos números grandes (<code>isSmall: false</code>) los podemos transformar a cadenas
de caracteres de la siguiente manera:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; fact(180).toString()
'200896062499134299656951336898466838917540340798867777940435335160044860953395980941180138112097309735631594101037399609671032132186331495273609598531966730972945653558819806475064353856858157445040809209560358463319644664891114256430017824141796753818192338642302693327818731986039603200000000000000000000000000000000000000000000'</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_otros_ejercicios_que_puedes_hacer">10. Otros ejercicios que puedes hacer</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Implementa la función <code>myLength</code>, la cual toma un <em>array</em> como entrada y
retorna la longitud de dicho <em>array</em> o número de elementos. Ejemplo:
<code>myLength([1, 2, 3]) = 3</code></p>
</li>
<li>
<p>Crea una función <code>cycle</code> que toma un número entero positivo y un <em>array</em> como
argumentos y crea un nuevo <em>array</em> que contendrá los elementos del <em>array</em> de
entrada multiplicados tantas veces como indica el número entero positivo pasado
como primer argumento. Ejemplo: <code>cycle(2, [1, 2, 3]) = [1, 2, 3, 1, 2, 3]</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referencias">11. Referencias</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.codecademy.com/en/courses/javascript-lesson-205">Recursion in JavaScript</a> por Code Academy</p>
</li>
<li>
<p><a href="http://eloquentjavascript.net/03_functions.html#h_D2Yui+mx6D">The Call Stack</a> de Marijn Haverbeke</p>
</li>
<li>
<p><a href="http://shop.oreilly.com/product/0636920028857.do">Functional Javascript</a> de Michael Fogus</p>
</li>
<li>
<p><a href="https://taylodl.wordpress.com/2013/06/07/functional-javascript-tail-call-optimization-and-trampolines/">Functional JavaScript – Tail Call Optimization and Trampolines</a></p>
</li>
<li>
<p><a href="http://raganwald.com/2013/03/28/trampolines-in-javascript.html">Trampolines in JavaScript</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-07-27 01:25:17 CDT
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>